<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright 2017 SIGEM.
     Auteur : Sadjidine Salifou OMBOTIMBE
     License LGPL-3.0 or later (http://www.gnu.org/licenses/lgpl). -->

<odoo>
    <!-- DATAILS PEC ENCOURS LIST VIEW -->
    <!--<record id="proximas_details_pec_encours_list" model="ir.ui.view">
        <field name="name">proximas details pec encours list</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Details PEC" create="0" edit="0" delete="0">
                <field name="num_pec"/>
                <field name="date_execution"/>
                <field name="code_id"/>
                <field name="assure_id" string="Assuré"/>
                <field name="prestataire"/>
                <field name="details_prestation" string="Désignation"/>
                &lt;!&ndash;<field name="quantite" string="QTE."/>&ndash;&gt;
                &lt;!&ndash;<field name="cout_unite" string="Coût Unit."/>&ndash;&gt;
                <field name="cout_total" string="S/Total" sum="S/Total"/>
                <field name="total_pc" sum="Total PC"/>
                <field name="total_npc" sum="Total NPC"/>
                <field name="taux_couvert" string="Taux(%)"/>
                <field name="net_tiers_payeur" sum="Part SAM"/>
                <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod."/>
                <field name="net_prestataire" sum="Net Prestataire"/>
            </tree>
        </field>
    </record>-->
    <!-- DATAILS PEC TREE -->
    <record id="proximas_details_pec_track_list" model="ir.ui.view">
        <field name="name">proximas details pec tree</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Details PEC">
                <field name="num_pec"/>
                <field name="date_execution"/>
                <field name="code_id"/>
                <field name="assure_id" string="Assuré"/>
                <field name="prestataire"/>
                <field name="details_prestation" string="Désignation"/>
                <field name="quantite" string="QTE."/>
                <field name="cout_unite" string="Coût Unit."/>
                <field name="cout_total" string="S/Total" sum="S/Total"/>
                <field name="total_pc" sum="Total PC"/>
                <field name="total_npc" sum="Total NPC"/>
                <field name="taux_couvert" string="Taux(%)"/>
                <field name="net_tiers_payeur" sum="Part SAM"/>
                <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod."/>
                <field name="net_prestataire" sum="Net Prestataire"/>
                <field name="net_a_payer"/>
            </tree>
        </field>
    </record>
    <!-- DETAILS PEC SEARCH VIEW -->
    <record id="details_pec_search_view" model="ir.ui.view">
        <field name="name">details.pec.search</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <search string="Détails Prise en charge (Prestations)">
                <field name="num_pec"/>
                <field name="assure_id"/>
                <field name="police_id"/>
                <field name="prestataire"/>
                <field name="date_execution"/>
                <field name="exo_sam"/>
                <field name="code_id" />
                <field name="nom"/>
                <field name="prenoms"/>
                <field name="date_naissance"/>
                <field name="genre"/>
                <field name="statut_familial" />
                <field name="date_debut_assure"/>
                <field name="date_fin_prevue_assure"/>
                <field name="contrat_id" />
                <newline />
                <group expand="0" string="Grouper par...">
                    <filter string="Code PEC"
                            domain="[]"
                            context="{'group_by':'num_pec'}" />
                    <filter string="Rubrique Médicale"
                            domain="[]"
                            context="{'group_by':'rubrique_id'}" />
                    <filter string="Prestation Médicale"
                            domain="[]"
                            context="{'group_by':'prestation_id'}" />
                    <filter string="Statut Familial"
                            domain="[]"
                            context="{'group_by':'statut_familial'}" />
                    <filter string="Genre"
                            domain="[]"
                            context="{'group_by':'genre'}" />
                    <filter string="Assuré"
                            domain="[]"
                            context="{'group_by':'assure_id'}" />
                    <filter string="Date exécution"
                            domain="[]"
                            context="{'group_by':'date_execution'}" />
                    <filter string="Contrat"
                            domain="[]"
                            context="{'group_by':'contrat_id'}" />
                    <filter string="Adhérent"
                            domain="[]"
                            context="{'group_by':'adherent_id'}" />
                    <filter string="Police"
                            domain="[]"
                            context="{'group_by':'police_id'}" />
                    <filter string="Prestataire"
                            domain="[]"
                            context="{'group_by':'prestataire'}" />
                </group>
            </search>
        </field>
    </record>
    <!-- DETAILS PEC TREE -->
    <record id="proximas_details_pec_list_view" model="ir.ui.view">
        <field name="name">proximas details pec list</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Details PEC" create="0" edit="0">
                <field name="num_pec"/>
                <!--<field name="facture_id"/>-->
                <field name="code_id"/>
                <field name="contrat_id" invisible="1"/>
                <field name="adherent_id" invisible="1"/>
                <field name="police_id" options ='{"no_open": True, "no_create": True}'/>
                <field name="assure_id" options ='{"no_open": True, "no_create": True}'/>
                <field name="date_execution"/>
                <field name="prestataire"
                       string="Prestataire de soins"
                       options ='{"no_open": True, "no_create": True}'
                />
                <field name="prestation_id"
                       string="Prestation médicale"
                       options ='{"no_open": True, "no_create": True}'
                />
                <field name="rubrique_id"/>
                <field name="current_user" invisible="1"/>
                <field name="user_prestataire" invisible="1"/>
                <field name="user_prestation" invisible="1"/>
                <field name="cout_total" sum="Totaux PC"/>
                <field name="total_pc" sum="Totaux Hors PC"/>
                <field name="taux_couvert"/>
                <field name="net_tiers_payeur" sum="Totaux Part SAM"/>
                <field name="ticket_moderateur" sum="Totaux Ticket Modérateur"/>
                <field name="net_prestataire" sum="Totaux Prestataire"/>
                 <field name="pec_state"/>
            </tree>
        </field>
    </record>
    <!-- PRISE EN CHARGE SEARCH VIEW -->
    <record id="prise_charge_view_search" model="ir.ui.view">
        <field name="name">prise.charge.search</field>
        <field name="model">proximas.prise.charge</field>
        <field name="arch" type="xml">
            <search string="Prise en charge Patients">
                <field name="code_pec"/>
                <field name="num_bon"/>
                <field name="prestataire_cro"/>
                <field name="date_saisie"/>
                <field name="code_id_externe" />
                <field name="code_id" />
                <field name="nom"/>
                <field name="prenoms"/>
                <field name="date_naissance"/>
                <field name="genre"/>
                <field name="statut_familial" />
                <field name="date_debut_assure"/>
                <field name="date_fin_prevue_assure"/>
                <field name="contrat_id" invisible="1" />
                <filter name="code_id"
                        string="Assuré"
                        domain="[]" />
                <separator />
                <filter name="contrat_id"
                        string="Contrat"
                        domain="[]" />
                <separator />
                <filter name="statut_familial"
                            string="Lien Parenté"
                            domain="[]" />
                    <separator />
                <newline />
                <group expand="0" string="Grouper par...">
                    <filter string="Assuré"
                            domain="[]"
                            context="{'group_by':'code_id'}" />
                    <filter string="Date Saisie"
                            domain="[]"
                            context="{'group_by':'date_saisie'}" />
                    <filter string="Contrat"
                            domain="[]"
                            context="{'group_by':'contrat_id'}" />
                    <filter string="Prestataire-CRO"
                            domain="[]"
                            context="{'group_by':'prestataire_id'}" />
                </group>
            </search>
        </field>
    </record>
    <!-- PRISE EN CHARGE LIST FILTER VIEW -->
    <record id="proximas_pec_list_filter_view" model="ir.ui.view">
        <field name="name">proximas.pec.tree</field>
        <field name="model">proximas.prise.charge</field>
        <field name="arch" type="xml">
            <tree string="Prise en charge Assuré" create="0">
                <field name="code_pec"/>
                <field name="prestataire_cro"/>
                <field name="date_saisie"/>
                <field name="code_id" />
                <field name="num_bon"/>
                <field name="name" />
                <field name="age" />
                <field name="statut_familial"/>
                <field name="genre"/>
                <field name="num_contrat"/>
                <!--<field name="totaux_cro"/>
                <field name="totaux_crs"/>
                <field name="totaux_phcie"/>-->
                <field name="sous_totaux_pec"/>
                <field name="state"/>
            </tree>
        </field>
    </record>
    <!-- PRISE EN CHARGE TREE -->
    <record id="proximas_pec_view_tree" model="ir.ui.view">
        <field name="name">proximas.pec.tree</field>
        <field name="model">proximas.prise.charge</field>
        <field name="arch" type="xml">
            <tree string="Prise en charge Assuré" create="0">
                <field name="code_pec"/>
                <field name="code_id" />
                <field name="num_bon"/>
                <field name="date_saisie"/>
                <field name="name" />
                <field name="age" />
                <field name="statut_familial"/>
                <field name="genre"/>
                <field name="prestataire_id"/>
                <field name="state"/>
            </tree>
        </field>
    </record>
    <!-- PRISE EN CHARGE FORM VIEW -->
    <record id='proximas_pec_form' model='ir.ui.view'>
        <field name='name'>Création de Prise en Charge view</field>
        <field name='model'>proximas.prise.charge</field>
        <field name='arch' type='xml'>
            <form string="Création Prise en charge Assuré" create="0">
                <header>
                    <button name="%(action_print_prise_en_charge_calibre)d" string="Imprimer Prise en charge"
                            type="action" icon="fa-file-o" class="oe_highlight"
                            help="Aperçu et édition du bulletin de prise en charge."
                            attrs="{'invisible': ['|',('organisation','=','SIGEM'),'|',('nbre_prestations_fournies','=',0),('pathologie_id','=',False)]}"
                    />
                    <button name="%(action_print_pec_ctg_sigem)d" string="Imprimer PEC (CTG-SIGEM)"
                            type="action" icon="fa-file-o" class="oe_highlight"
                            help="Aperçu et édition du bulletin de prise en charge."
                            attrs="{'invisible': ['|',('organisation','!=','SIGEM'),'|',('nbre_prestations_fournies','=',0),('pathologie_id','=',False)]}"
                    />
                    <button name="Encours" type="workflow" icon="fa-backward"
                            string="Remettre en Cours" states="oriente,dispense,termine" class="btn btn-danger"
                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"
                            help="Permet de remettre la prise dans l'état de depart du workflow =>(En cours)."/>
                    <button name="Orientation" type="workflow"
                            string="Orientation Prestataire" icon="fa-hospital-o"
                            groups="proximas_medical.group_cro,base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"
                            attrs="{'invisible':['|',('nbre_prestations_fournies','=',0),'|',('nbre_prestations_demandes','=',0),
                            ('state','in',['oriente','dispense','termine'])]}"
                            confirm="Vous êtes sur le point de transférer la prise en charge vers un autre prestataire de soins.
                            Après cette opération, vous n'aurez plus accès à la prise en charge. Voulez-vous validez pour
                            confirmer l'orientation du patient?"
                            help="Orientation du patient vers un autre prestataire pour compléments de prise en charge." class="oe_highlight"/>
                            <!--states="cours,dispense"-->
                    <button name="Dispensation" type="workflow" icon="fa-plus-circle"
                            string="Transmettre à la Pharmacie" class="oe_highlight"
                            attrs="{'invisible': ['|',('state','=','dispense'),'|',('nbre_prestations_fournies','=',0),
                            ('nbre_prestations_demandes','!=',0),'|',('state','=','cours'),('state','=','termine')]}"
                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin,proximas_medical.group_cro,proximas_medical.group_crs"
                            confirm="Vous êtes sur le point de transmettre la prise en charge vers une pharmacie du réseau de soins.
                            Après cette opération, vous n'aurez plus accès à la prise en charge. Voulez-vous validez pour
                            confirmer l'opération de transfert vers la pharmacie pour dispensation de médicament(s) prescrit(s)?"
                            help="Transfert de la prise en charge vers une pharmacie, pour dispensation de médicaments."/>
                     <!--attrs="{'invisible': ['|','|',('state','in',['dipense','termine']),('nbre_prestations_fournies','=',0),('nbre_prestations_demandes','!=',0),('state','=','cours')]}"-->
                    <!--attrs="{'invisible': ['&amp;',('nbre_prestations_fournies','=',0),'|',('state','=','cours'),'&amp;',('nbre_prestations_demandes','!=',0),'|',('state','=','cours'),('state','in',['dipense','termine'])]}"-->
                    <button name="Terminer" type="workflow" icon="fa-lock"
                            string="Terminer" class="oe_highlight"
                            attrs="{'invisible': ['|',('state','=','termine'),('state','in',['cours','oriente']),'|',
                            ('nbre_prescriptions','!=',0),'|',('nbre_prestations_fournies','=',0),('nbre_prestations_demandes','!=',0),('state','=','cours')]}"
                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin,
                            proximas_medical.group_operator,proximas_medical.group_cro,proximas_medical.group_crs,
                            proximas_medical.group_pharmacy"
                            confirm="Vous êtes sur le point de mettre fin au processus de traitement de la prise en charge.
                            Vos données seront sauvegardées et cela validera définitivement la prise en charge. Êtes-vous
                            sûr de vouloir terminer le processus ?"
                            help="Mettre fin au processus de traitement de la prise en charge (Fin de parcours)."
                    />
                    <!--attrs="{'invisible': [('state','in',['cours','oriente']),('nbre_prescriptions','!=',0),'|',('state','in',['termine'])]}"-->
                            <!--states="cours,oriente,dispense"-->
                    <field name="state" widget="statusbar"/><!-- statusbar_visible="cours,oriente,termine,expire,dispense"-->
                </header>
                <sheet>
                    <div class="oe_right oe_button_box" name="buttons">
                        <button name="proximas_medical.proximas_list_pec_filter_action" class="oe_stat_button"
                                icon="fa-user-md"
                                type="action"
                                domain="[]"
                                context="{'search_default_code_id': code_id}">
                            <field name="totaux_cro" widget="statinfo" string="Totaux CRO" />
                        </button>
                        <button class="oe_stat_button" name="proximas_medical.proximas_details_pec_encours_action"
                                type="action"
                                icon="fa-stethoscope"
                                domain="[]"
                                context="{'search_default_code_id': code_id}">
                            <field name="totaux_crs" widget="statinfo"
                                   options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'
                                   string="Totaux CRS" />
                        </button>
                        <button class="oe_stat_button" name="proximas_medical.proximas_details_pec_encours_action"
                                type="action"
                                icon="fa-plus-square"
                                domain="[]"
                                context="{'search_default_contrat_id': contrat_id}">
                            <field name="totaux_phcie" widget="statinfo" string="Totaux Phcie"/>
                        </button>
                        <button class="oe_stat_button" name="proximas_medical.proximas_details_pec_encours_action"
                                type="action"
                                icon="fa-pencil-square-o"
                                domain="[]"
                                context="{'search_default_pec_id': id,'search_default_prestataire': prestataire_id}">
                            <field name="nbre_prestations_fournies" widget="statinfo" string="Actes CRO"/>
                        </button>
                        <button class="oe_stat_button" name="proximas_medical.proximas_details_pec_encours_action"
                                type="action"
                                icon="fa-pencil"
                                domain="[]"
                                context="{'search_default_pec_id': id,'search_default_prestataire': prestataire_crs_id}">
                            <field name="nbre_prestations_demandes" widget="statinfo" string="Actes CRS"/>
                        </button>
                        <button class="oe_stat_button" name="proximas_medical.proximas_details_pec_encours_action"
                                type="action"
                                icon="fa-pencil-square"
                                domain="[]"
                                context="{'search_default_pec_id': id,'search_default_prestataire': prestataire_phcie_id}">
                            <field name="nbre_prescriptions" widget="statinfo" string="Prescriptions"/>
                        </button>
                    </div>
                        <field name="image"
                           widget='image'
                           class="oe_left oe_kanban_avatar"
                           options="{'preview_image': 'image', 'size': [120, 120]}"
                           readonly="1"/>
                        <!--<field name="image" widget='image' class="oe_avatar oe_left"/>-->
                    <div class="oe_title oe_left" name="title">
                        <label for="name" string="Identification Patient / Bénéficiaire:"/>
                        <h2><field name="name" class="bg-info text-primary" readonly="True"/></h2>
                        <!--<h3><field name="prenoms" class="text-primary" readonly="True"/></h3>-->
                        <b><field name="age_details" class="text-info"/></b>
                        <h3><field name="statut_familial" class="text-info" string="Lien Parenté :"/></h3>
                        <!--<field name="taux_plafond_sinistres_assure" widget="progressbar"/>-->
                        <!--<field name="maximum_rate" invisible="1"/>-->
                    </div>
                    <newline/>
                    <div class="oe_right text-center">
                        <!--<div class="oe_left">-->
                            <field name="code_pec" invisible="1"/>
                            <!--<label for="code_pc" string="Code PEC :"/>-->
                            <h2 class="bg-primary"><field name="code_pc"/></h2>
                        <!--</div>-->
                            <label for="totaux_phcie_estimation" string="Estimation Prescriptions:"/>
                            <h2 class="text-success">
                                <field name="totaux_phcie_estimation" widget="monetary"
                                       options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/>
                            </h2>
                    </div>
                    <notebook>
                        <page string="DETAILS PRISE EN CHARGE:">
                             <group>
                                <group>
                                    <field name="code_saisi" invisible="1" readonly="1"/>
                                    <field name="date_saisie"
                                           readonly="0"
                                           groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"
                                    />
                                    <!--groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"-->
                                    <field name="num_bon"/>
                                    <field name="date_last_pec" string="Dernière Prise en Charge"/>
                                    <field name="pathologie_id"
                                           options ='{"no_open": True, "no_create": True}'
                                           string="Code Affection (Principale)"
                                           attrs="{'required': [('nbre_prestations_fournies','!=',0)],
                                           'invisible': [('nbre_prestations_fournies','=',0)]}"
                                    />
                                    <field name="pathologie_ids" widget="many2many_tags"
                                           string="Affections associées"
                                           placeholder="indiquez le(s) code(s) affection ici..."
                                           options ='{"no_open": True, "no_create": True}'
                                           attrs="{'invisible': [('pathologie_id','=',False)]}"
                                    />
                                    <!--<field name="pathologie_ids" widget="many2many_tags"
                                           placeholder="indiquez le(s) code(s) affection ici..."
                                           options ='{"no_open": True, "no_create": True}'
                                           attrs="{'invisible': ['|',('nbre_prestations_fournies','=',0),('state','=','dispense')]}"
                                    />-->
                                </group>
                                 <group>
                                     <field name="prestataire_id"
                                            domain="[('is_prestataire', '=', True),('categorie_id', '=', 'CRO')]" string="Centre de Référence"
                                            options='{"no_open": True, "no_create": True}' readonly="0"
                                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"
                                     />
                                     <field name="prestataire_crs_id" string="Centre d'Orientation"
                                            domain="[('is_prestataire', '=', True),('categorie_id', 'in', ['CRO','CRS'])]"
                                            options ='{"no_open": True, "no_create": True}'
                                            states="oriente,termine"
                                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,proximas_medical.group_admin"
                                     />
                                     <field name="pool_medical_id" string="Médecin Traitant - CRO"
                                            options='{"no_open": True, "no_create": True}'
                                            domain="['|',('prestataire_id', '=', prestataire_id),
                                            ('prestataire_id', '=', prestataire_crs_id)]" required="1"
                                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin,proximas_medical.group_cro"
                                     />
                                     <field name="prestataire_phcie_id" string="Pharmacie"
                                            options ='{"no_open": True, "no_create": True}'
                                            states="dispense,termine"
                                            domain="[('is_prestataire', '=', True),('categorie_id', '=', 'Pharmacie')]"
                                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"
                                     />
                                     <field name="leve_plafond_prescription"
                                            states="dispense"
                                            groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"
                                            attrs="{'invisible': ['|',('mt_plafond_prescription','=',0),('mt_plafond_prescription','>=','totaux_phcie')]}"
                                     />
                                     <field name="nbre_prescriptions_medecin"/>
                                     <field name="mt_plafond_prescription" invisible="1"/>
                                     <!--<field name="totaux_phcie" invisible="1"/>-->
                                     <field name="tot_encaisse_phcie" invisible="1"/>
                                     <!--<field name="mt_encaisse_cro" states="cours"/>
                                     <field name="mt_encaisse_crs" states="oriente"/>
                                     <field name="mt_encaisse_phcie" states="dispense"/>-->
                                 </group>
                             </group>
                        </page>
                        <page string="DETAILS ASSURE &amp; CONTRAT:">
                            <group col="6" colspan="2">
                                <group>
                                    <field name="code_id_externe"
                                           class="text-success"
                                           attrs="{'invisible':[('code_id_externe','=',False)]}"
                                    />
                                    <field name="code_id" class="text-primary"/>
                                    <field name="assure_id" string="Nom &amp; Prénoms"
                                           options='{"no_open": True, "no_create": True}'
                                           readonly="True" invisible="1"/>
                                    <field name="genre"/>
                                    <field name="date_naissance"/>
                                    <field name="organisation" invisible="1"/>
                                    <field name="structure_id" options='{"no_open": True, "no_create": True}'
                                           invisible="0"/>
                                </group>
                                <group>
                                    <field name="adherent"
                                           string="Adhérent" options='{"no_open": True, "no_create": True}'
                                           class="text-primary"/>
                                    <field name="num_contrat"/>
                                    <field name="contrat_id" invisible="1"/>
                                    <field name="police_id" options='{"no_open": True, "no_create": True}'/>
                                    <field name="delai_pec"/>
                                    <field name="user_id"
                                           readonly="1"
                                           invisible="1"
                                           options='{"no_open": True, "no_create": True}'
                                    />
                                    <field name="current_user"
                                           invisible="1"
                                           options='{"no_open": True, "no_create": True}'
                                    />
                                    <field name="date_debut_assure"/>
                                    <!--<t t-set="date_debut" t-value="datetime.datetime.strptime(date_debut_assure, '%Y-%m-%d').strftime('%Y/%m/%d')"/>-->
                                </group>
                                <group>
                                    <field name="validite_pec"/>
                                    <field name="is_valide"/>
                                    <field name="is_termine"/>
                                    <field name="nbre_prescription_maxi"/>
                                    <field name="date_fin_prevue_assure"/>
                                    <!--<field name="user_prise_charge"/>-->
                                    <!--<field name="nbre_prestations_fournies"/>-->
                                </group>
                            </group>
                        </page>
                        <page string="ANTECEDENTS MEDICAUX - ASSURE">
                            <group col="4" colspan="2">
                                <field name="antecedent_pathologies_ids"
                                       string="Pathologies Chroniques"
                                       widget="many2many_list"
                                       class="bg-success">
                                    <form>
                                        <sheet>
                                            <group col="4" colspan="2">
                                                <field name="name" readonly="1"
                                                       string="Code"/>
                                                <field name="libelle" readonly="1"/>
                                                <field name="specialite_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       string="Spécialité médicale" readonly="1"/>
                                                <field name="est_risque"  readonly="1"
                                                       string="Chronique?"/>
                                            </group>
                                        </sheet>
                                    </form>
                                    <tree create="0" edit="0" delete="0">
                                        <!--<field name="name" string="Code"/>-->
                                        <field name="libelle"/>
                                        <!--<field name="specialite_id" string="Spécialité médicale"/>-->
                                    </tree>
                                </field>
                            </group>
                            <group>
                                <field name="historique_assure_ids"
                                       string="Antécédents (Historique)"
                                       widget="one2many_list" class="bg-info text-primary">
                                    <tree>
                                         <field name="date_execution" string="Date Prestation "/>
                                        <field name="details_prestation" string="Soins médicaux / paramédicaux"/>
                                        <field name="medecin_id" string="Médecin Praticien"/>
                                        <field name="prestataire" string="Ets. Médical"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <!--<page string="CONTRÔLE NIVEAU SINISTRALITE / PLAFOND"
                              groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin,
                              proximas_medical.group_operator" >
                            <div class="oe_left">
                                <field name="niveau_sinistre_assure" string="Plafond Individuel" widget="percentpie"/>
                            </div>
                            <div class="oe_right">
                                <field name="niveau_sinistre_contrat" string="Plafond Famille" widget="percentpie"/>
                            </div>
                        </page>-->
                    </notebook>
                    <hr/>
                    <notebook>
                        <page string="ACTES MEDICAUX &amp; PARAMEDICAUX - (CRO)"
                              states="cours,termine">
                            <field name="details_pec_soins_ids"
                                   class="text-info"
                                   widget="one2many_list"
                                   context="{'default_prestataire_id':prestataire_id,'default_assure_id':assure_id,
                                   'default_pool_medical_id':pool_medical_id,'default_police_id':police_id,'default_structure_id':structure_id}"
                                   domain="[('prestataire_id', '=', prestataire_id)]"
                                   attrs="{'required': [('state','=','cours')]}"
                            >
                                <!--'form_view_ref': 'proximas_medical.details_pec_soins_form',-->
                                <!--attrs="{'required': [('state','=','cours')]}"-->
                                <!--'default_pool_medical_id':pool_medical_id-->
                                <form string="Détails de Prise en charge Assuré">
                                    <sheet>

                                        <notebook>
                                            <page string="DETAILS PRESTATION MEDICALE - CRO">
                                                <group invisible="1">
                                                    <field name="zone_couverte"/>
                                                </group>
                                                <group>
                                                    <div class="oe_title" name="title">
                                                        <label for="prestataire_id"
                                                               string="Prestataire de Soins Médicaux &amp; paramédicaux - CRO"
                                                        />
                                                        <h2 class="bg-info text-primary">
                                                            <field name="prestataire_id" required="1"
                                                               options='{"no_open": True, "no_create": True}'
                                                               context="{'default_prestataire_id':prestataire_id}"
                                                               readonly="1"
                                                            />
                                                        </h2>
                                                    </div>
                                                    <newline/>
                                                    <group>
                                                        <field name="assure_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"/>
                                                        <field name="pool_medical_id" string="Médecin/Praticien"
                                                               options='{"no_open": True, "no_create": True}'
                                                               ontext="{'default_pool_medical_id':pool_medical_id}"
                                                               domain="[('prestataire_id', '=', prestataire_id)]"
                                                               required="1"
                                                        />
                                                        <!--groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_admin"-->
                                                        <!--context="{'default_pool_medical_id':pool_medical_id}"-->
                                                        <field name="date_execution" required="1"/>
                                                        <!--<field name="exercice_id" invisible="0"/>-->
                                                        <field name="prestation_cro_id"
                                                               required="1"
                                                               options='{"no_open": True, "no_create": True}' class="text-primary"
                                                               domain="[('prestataire_id', '=', prestataire_id),('accord_prealable', '=', False),]"/>
                                                    </group>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-info">
                                                    <field name="date_dernier_acte" string="Date Dernier Acte "/>
                                                    <field name="exo_sam"/>
                                                    <!--<field name="exercice_id"-->
                                                           <!--string="Exercice SAM"-->
                                                           <!--options='{"no_open": True, "no_create": True}'/>-->
                                                     <field name="delai_prestation"/>
                                                </group>
                                                <hr/>
                                                <group>
                                                    <group col="6" colspan="2" >
                                                        <!--<separator string="Calculs Coûts:" />-->
                                                        <field name="cout_unit"
                                                               attrs="{'required': [('cout_modifiable','=',True)],'invisible': [('cout_modifiable','=',False)]}"
                                                        />
                                                        <field name="quantite_livre"
                                                               attrs="{'required': [('quantite_exige','=',True)],'invisible': [('quantite_exige','=',False)]}"
                                                        />
                                                        <newline/>
                                                        <field name="cout_unite"/>
                                                        <field name="coefficient"/>
                                                        <field name="forfait_sam" string="Forfait SAM"/>
                                                        <field name="forfait_ticket"/>
                                                        <field name="mt_plafond"/>
                                                        <field name="cout_total" string="Mt. Total"/>
                                                        <field name="total_pc" string="S/Total PC"/>
                                                        <field name="total_npc" string="S/Total NPC"/>
                                                        <field name="ticket_moderateur" class="bg-info" string="Ticket Mod."/>
                                                        <field name="taux_couvert" string="Taux Couverture"/>
                                                        <field name="net_tiers_payeur"
                                                               class="text-primary"
                                                               string="Part SAM"/>
                                                        <field name="net_prestataire"
                                                               class="bg-primary"
                                                               string="MONTANT NET DÛ =>"/>
                                                    </group>
                                                    <group invisible="1">
                                                        <field name="remise_prestation"/>
                                                        <field name="mt_rabais"/>
                                                        <field name="mt_paye_assure"
                                                               required="1" string="Montant Encaissé"
                                                        />
                                                        <!--attrs="{'readonly': [('ticket_exigible','=',True)]}"-->
                                                        <field name="debit_ticket"/>
                                                        <field name="cout_modifiable"/>
                                                        <field name="quantite_exige"/>
                                                    </group>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-info">
                                                    <field name="prestation_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"
                                                    />
                                                    <field name="cout_unitaire" string="Coût Actuel"
                                                           attrs="{'invisible': [('cout_unitaire','=',0)]}"
                                                    />
                                                    <field name="arret_prestation" readonly="1"/>
                                                </group>
                                                <group col="6" colspan="2" class="bg-primary">
                                                    <field name="code_medical_id"
                                                           options='{"no_open": True, "no_create": True}'/>
                                                    <field name="rubrique_id" string="Rubrisue médicale"
                                                           options='{"no_open": True, "no_create": True}'/>
                                                    <field name="ticket_exigible" string="Ticket Exigible?"/>
                                                </group>
                                                <group col="6" colspan="2" invisible="1">
                                                    <field name="delai_attente_prestation" string="Délai d'attente Prestation"/>
                                                    <field name="accord_prealable"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,
                                                        proximas_medical.group_medecin">
                                                    <field name="totaux_rubrique_assure" string="Sinistres Rubrique Assuré"/>
                                                    <field name="totaux_rubrique_contrat" string="Sinistres Rubrique Famille"/>
                                                    <field name="nbre_actes_rubrique_assure"/>
                                                    <field name="nbre_actes_rubrique_contrat" invisible="1"/>
                                                </group>
                                            </page>
                                        </notebook>
                                    </sheet>
                                </form>
                                <tree default_order="date_execution desc">
                                    <!--<field name="pec_id"/>-->
                                    <field name="date_execution"/>
                                    <!--<field name="pool_medical_id"/>-->
                                    <!--<field name="prestataire"/>-->
                                    <field name="prestation_cro_id" string="Prestation Médicale"/>
                                    <field name="cout_unite" string="Coût Unit."/>
                                    <field name="coefficient" string="Coéf." />
                                    <!--<field name="cout_unitaire" string="Coût Unit." invisible="context.get('cout_unit',True)==0"/>-->
                                    <!--<field name="cout_unit" string="Coût Unit." invisible="context.get('cout_unitaire',True)==0"/>-->
                                    <field name="cout_total" string="S/Total" sum="S/Total"/>
                                    <field name="total_pc" sum="S/Total PC"/>
                                    <field name="total_npc" sum="S/Total NPC"/>
                                    <field name="taux_couvert"/>
                                    <field name="net_tiers_payeur" sum="Part SAM"/>
                                    <field name="ticket_moderateur" string="Ticket mod." sum="Ticket mod."/>
                                    <!--<field name="mt_paye_assure" sum="Totaux Payé:"/>-->
                                    <field name="net_prestataire" sum="Net à payer"/>
                                    <!--<field name="debit_ticket" sum="Débit Ticket:"/>-->
                                </tree>
                            </field>
                            <group>
                                <group class="oe_subtotal_footer oe_right text-primary">
                                   <field name="part_sam_cro"/>
                                   <field name="ticket_moderateur_cro"/>
                                   <field name="mt_totaux_cro" class="oe_subtotal_footer_separator"/>
                                   <field name="ticket_exigible_cro"/>
                                   <field name="mt_encaisse_cro" string="Montant Perçu (Ticket Modérateur)"/>
                                   <field name="net_prestataire_cro" class="oe_subtotal_footer_separator"/>
                                </group>
                            </group>
                        </page>
                        <page string="DEMANDE ACTES MEDICAUX &amp; PARAMEDICAUX -(CRS)"
                              states="cours">
                            <!--&gt;states="cours,oriente,termine"-->
                            <!--attrs="{'invisible': ['|',('state','=','dispense'),'|',('nbre_prestations_fournies','=',0),
                              ('state','=','cours'),('nbre_prescriptions','!=',0)]}"-->
                            <field name="details_pec_demande_crs_ids"
                                   widget="one2many"
                                   class="text-info"
                                   context="{'default_prestataire_id':prestataire_id, 'default_assure_id':assure_id,
                                   'default_pool_medical_id':pool_medical_id,'default_police_id':police_id,
                                   'default_structure_id':structure_id}">
                                <!--attrs="{'required': [('state','=','oriente')]}"-->
                                <!--'form_view_ref': 'proximas_medical.details_pec_crs_soins_form',-->
                                <form string="Détails de Prise en charge Assuré">
                                    <sheet>
                                        <notebook>
                                            <page string="DEMANDE PRESTATION MEDECALE-CRS">
                                                <group invisible="1">
                                                    <field name="zone_couverte"/>
                                                </group>
                                                <group>
                                                    <field name="assure_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"/>
                                                    <field name="date_demande"
                                                           required="1"
                                                    />
                                                    <field name="prestataire_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"/>
                                                    <field name="pool_medical_id" string="Médecin Prescripteur"
                                                           options='{"no_open": True, "no_create": True}'
                                                           required="1"/>
                                                    <!--attrs="{'readonly': [('prestataire_crs_id','!=',False)]}"-->
                                                    <field name="prestation_demande_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           required="1"
                                                    />
                                                    <field name="date_dernier_acte" string="Date dernier acte"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" invisible="0">
                                                    <field name="delai_attente_prestation" string="Délai Attente Prestation"/>
                                                    <field name="delai_prestation"/>
                                                    <field name="accord_prealable"/>
                                                </group>
                                            </page>
                                            <page string="INFOS CLINIQUES - DEMANDE ACCORD PREALABLE">
                                                <group>
                                                    <field name="info_clinique" widget="html"/>
                                                    <field name="doc_info_clinique"
                                                           widget="binary"
                                                           filename="doc_filename"
                                                    />
                                                    <field name="doc_filename"
                                                           invisible="1"
                                                    />
                                                </group>
                                            </page>
                                            <page string="ACCORD PREALABLE/MEDECIN CONSEIL"
                                                  groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,
                                                        proximas_medical.group_medecin"
                                                  attrs="{'invisible': [('accord_prestation_demande','=',False)]}">
                                                <group col="4" colspan="2">
                                                    <field name="accorde"/>
                                                    <field name="non_accorde"/>
                                                </group>
                                                <group>
                                                    <field name="accord_prestation_demande"
                                                           invisible="1"
                                                    />
                                                    <field name="motif_non_accord"
                                                           attrs="{'invisible': [('accorde','=',True)],'required': [('non_accorde','=',True)]}"
                                                    />
                                                </group>
                                            </page>
                                        </notebook>
                                    </sheet>
                                </form>
                                <tree default_order="date_demande desc">
                                    <!--<field name="pec_id"/>-->
                                    <field name="date_demande"/>
                                    <!--<field name="pool_medical_id"/>-->
                                    <field name="prestation_demande_id"/>
                                    <field name="coefficient" string="Coeff"/>
                                    <field name="cout_unite" string="Coût Unit."/>
                                    <field name="cout_total" string="S/Total" sum="S/Total"/>
                                    <field name="total_pc" sum="S/Total PC"/>
                                    <field name="total_npc" sum="S/Total NPC"/>
                                    <field name="taux_couvert"/>
                                    <field name="net_tiers_payeur" sum="Part SAM"/>
                                    <field name="ticket_moderateur" string="Ticket mod." sum="Ticket mod."/>
                                    <field name="net_prestataire" string="Net. Prestataire" sum="Net à payer"/>
                                </tree>
                            </field>
                        </page>
                        <page string="ACTES MEDICAUX &amp; PARAMEDICAUX - CRS"
                              states="oriente,termine">
                            <!--&gt;states="cours,oriente,termine"-->
                            <!--attrs="{'invisible': ['|',('state','=','dispense'),'|',('nbre_prestations_fournies','=',0),
                              ('state','=','cours'),('nbre_prescriptions','!=',0)]}"-->
                            <field name="details_pec_soins_crs_ids"
                                   widget="one2many"
                                   class="text-info"
                                   attrs="{'required': [('state','in',['oriente'])]}"
                                   domain="[]"
                                   context="{'default_prestataire_id':prestataire_id, 'default_assure_id':assure_id,
                                   'default_pool_medical_id':pool_medical_id,'default_prestataire_crs_id':prestataire_crs_id,
                                   'default_police_id':police_id,'default_structure_id':structure_id}">
                                <!--'form_view_ref': 'proximas_medical.details_pec_crs_soins_form',-->
                                <form string="Détails de Prise en charge Assuré">
                                    <sheet>
                                        <notebook>
                                            <page string="PRESTATION MEDICALE-CRS">
                                                <group invisible="1">
                                                    <field name="zone_couverte"/>
                                                </group>
                                                <group>
                                                    <field name="assure_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"/>
                                                    <field name="prestation_demande_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           attrs="{'readonly': [('prestataire_crs_id','!=',False)],
                                                           'required': [('date_demande','!=',False)],
                                                           'invisible': [('date_demande','=',False)]}"
                                                           />
                                                    <field name="date_demande"
                                                           attrs="{'readonly': [('prestataire_crs_id','!=',False)],
                                                           'required': [('prestation_demande_id','!=',False)],'invisible': [('prestation_demande_id','=',False)]}"
                                                    />
                                                    <field name="prestataire_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"/>
                                                    <field name="pool_medical_id" string="Médecin Prescripteur"
                                                           options='{"no_open": True, "no_create": True}'
                                                           attrs="{'readonly': [('prestataire_crs_id','!=',False)],
                                                           'required': [('prestation_demande_id','!=',False)],
                                                           'invisible': [('date_demande','=',False)]}"
                                                           />
                                                    <!--attrs="{'readonly': [('prestataire_crs_id','!=',False)]}"-->
                                                    <field name="prestataire_crs_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"
                                                           attrs="{'invisible': [('prestataire_crs_id','=',False)],
                                                           'required': [('date_execution','!=', False)]}"
                                                           />
                                                    <!--<field name="prestation_crs_id"
                                                       options='{"no_open": True, "no_create": True}' class="text-primary"
                                                       domain="[('prestataire_id', '=', prestataire_id),('active', '=', True)]"/>-->
                                                </group>
                                            </page>
                                            <page string="DETAILS COÛTS - PRESTATION MEDICALE (CRS)"
                                                   attrs="{'invisible': [('prestataire_crs_id','=', False)]}">
                                                <div class="oe_title" name="title">
                                                    <label for="prestataire" string="Prestataire de Soins Médicaux &amp; paramédicaux - CRS"
                                                           class="oe_edit_only"/>
                                                    <h2 class="bg-warning text-warning">
                                                        <field name="prestataire"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"
                                                        />
                                                        <!--context="{'default_prestataire_id':prestataire_id}"-->
                                                    </h2>
                                                </div>
                                                <newline/>
                                                <group string="Détails - Exécution Prestation Médicale">
                                                    <field name="date_execution"
                                                       attrs="{'required': [('pool_medical_crs_id','!=', False)]}"
                                                    />
                                                    <field name="pool_medical_crs_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       domain="[('prestataire_id', '=', prestataire_crs_id)]"
                                                       attrs="{'required': [('prestataire_crs_id','!=', False)],
                                                       'invisible': [('prestataire_crs_id','=', False)]}"
                                                       />
                                                    <field name="prestation_crs_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           domain="[('prestataire_id', '=', prestataire_crs_id),
                                                           ('active', '=', True)]"
                                                           attrs="{'required': [('prestation_demande_id','=', False)],
                                                           'invisible': [('prestation_demande_id','!=', False)]}"
                                                    />
                                                    <field name="details_prestation" invisible="1"/>
                                                    <!--<field name="prestation_id"/>-->
                                                    <field name="prestation_id"
                                                           string="Prestation médicale"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1"
                                                           class="h4 bg-warning text-warning"
                                                           domain="[('prestataire_id', '=', prestataire_crs_id),('active', '=', True)]"
                                                    />
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-warning">
                                                    <field name="date_dernier_acte" string="Date Dernier Acte"/>
                                                    <field name="exo_sam"/>
                                                    <!--<field name="exercice_id"-->
                                                           <!--string="Exercice SAM"-->
                                                           <!--options='{"no_open": True, "no_create": True}'/>-->
                                                    <field name="arret_prestation" readonly="1"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" string="Détails Coûts - Prestation médicale">
                                                    <field name="cout_unit"
                                                       attrs="{'required': [('cout_modifiable','=',True)],'invisible': [('cout_modifiable','=',False)]}"
                                                    />
                                                    <field name="quantite_livre"
                                                           attrs="{'required': [('quantite_exige','=',True)],'invisible': [('quantite_exige','=',False)]}"
                                                    />
                                                    <newline/>
                                                    <field name="cout_unitaire"
                                                           string="Coût Unitaire"
                                                           attrs="{'invisible': [('cout_unitaire','=',0)]}"
                                                    />
                                                    <field name="forfait_sam" attrs="{'invisible': [('mt_forfait','>',0)]}"/>
                                                    <field name="forfait_ticket" attrs="{'invisible': [('mt_forfait','>',0)]}"/>
                                                    <field name="mt_forfait" attrs="{'invisible': [('forfait_sam','>',0)]}"/>
                                                    <field name="mt_plafond"
                                                           string="Mt. Plafond"
                                                           attrs="{'invisible': [('mt_plafond','=',False)]}"
                                                    />
                                                    <field name="coefficient"
                                                           string="Coeff.(Qté.)"
                                                    />
                                                    <field name="cout_total"/>
                                                    <field name="total_pc"/>
                                                    <field name="total_npc"/>
                                                    <field name="taux_couvert"/>
                                                    <field name="net_tiers_payeur"/>
                                                    <field name="ticket_moderateur" class="bg-warning"/>
                                                    <field name="net_prestataire"
                                                           class="bg-warning"
                                                           string="NET DÛS (SAM)"/>
                                                </group>
                                                <group invisible="1">
                                                    <field name="cout_unite"/>
                                                    <field name="remise_prestation"/>
                                                    <field name="mt_rabais"/>
                                                    <field name="cout_modifiable" invisible="1"/>
                                                    <field name="quantite_exige" invisible="1"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-warning">
                                                    <field name="code_medical_id"
                                                           options='{"no_open": True, "no_create": True}'/>
                                                    <field name="rubrique_id" class="text-primary"
                                                           options='{"no_open": True, "no_create": True}'/>
                                                    <field name="ticket_exigible" string="Ticket Exigible?"/>
                                                </group>
                                                <group col="6" colspan="2">
                                                    <field name="delai_attente_prestation" string="Délai d'attente Prestation"/>
                                                     <field name="delai_prestation"/>
                                                    <field name="accord_prealable"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,
                                                        proximas_medical.group_medecin">
                                                    <field name="totaux_rubrique_assure" string="Sinistres Rubrique Assuré"/>
                                                    <field name="totaux_rubrique_contrat" string="Sinistres Rubrique Famille"/>
                                                    <field name="nbre_actes_rubrique_assure"/>
                                                    <field name="nbre_actes_rubrique_contrat" invisible="1"/>
                                                </group>
                                            </page>
                                            <page string="ACCORD PREALABLE/MEDECIN CONSEIL"
                                                  groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,
                                                        proximas_medical.group_conseil"
                                                  attrs="{'invisible': [('accord_prealable','=',False)]}"
                                            >
                                            <!--&gt; attrs="{'invisible': [('accord_prealable','=',False)]}"-->
                                                <group>
                                                    <field name="accord_prealable"/>
                                                    <field name="accorde"/>
                                                    <field name="motif_non_accord"
                                                           attrs="{'invisible': [('accorde','=',True)]}"
                                                    />
                                                    <field name="info_clinique"/>
                                                </group>
                                             </page>
                                        </notebook>
                                    </sheet>
                                    <!--<sheet position="after">
                                        <div class="oe_chatter">
                                            <field name="message_follower_ids" widget="mail_followers" groups="base.group_user,group_admin"/>
                                            <field name="message_ids" widget="mail_thread"/>
                                        </div>
                                    </sheet>-->
                                </form>
                                <tree default_order="date_execution desc" create="0">
                                    <!--<field name="date_demande"/>-->
                                    <field name="date_execution"/>
                                    <field name="prestation_demande_id"/>
                                    <field name="prestation_id" string="Prestation Exécutée"/>
                                    <!--<field name="prestation_id" attrs="{'invisible': [('cout_unit','=', False)]}"/>-->
                                    <field name="coefficient" string="Coéf."/>
                                    <field name="cout_unite" string="Coût Unit."/>
                                    <field name="cout_total" string="S/Total" sum="S/Total"/>
                                    <field name="total_pc" sum="S/Total PC"/>
                                    <field name="total_npc" sum="S/Total NPC"/>
                                    <field name="taux_couvert"/>
                                    <field name="net_tiers_payeur" sum="Part SAM"/>
                                    <field name="ticket_moderateur" string="Ticket mod." sum="Ticket mod."/>
                                    <field name="net_prestataire" sum="Net à payer"/>
                                </tree>
                            </field>
                            <group>
                                <group class="oe_subtotal_footer oe_right text-primary">
                                   <field name="part_sam_crs"/>
                                   <field name="ticket_moderateur_crs"/>
                                   <field name="mt_totaux_crs" class="oe_subtotal_footer_separator"/>
                                   <field name="ticket_exigible_crs"/>
                                   <field name="mt_encaisse_crs" string="Montant Perçu (Ticket Modérateur)"/>
                                   <field name="net_prestataire_crs" class="oe_subtotal_footer_separator"/>
                                </group>
                            </group>
                        </page>
                        <page string="PRESCRIPTION DE MEDICAMENTS/ORDONNANCE"
                              attrs="{'invisible':['|','|',('state','in',['dispense','termine']),
                              ('nbre_prestations_fournies','=',0),('nbre_prestations_demandes','!=',0)]}">
                            <field name="details_pec_prescription_ids"
                                   widget="one2many"
                                   class="text-info"
                                   domain="[('date_execution', '=', None)]"
                                   context="{
                                   'default_prestataire_id':prestataire_id,'default_assure_id':assure_id,'default_police_id':police_id,
                                   'default_prestataire_crs_id':prestataire_crs_id,'default_prestataire_phcie_id':prestataire_phcie_id,
                                   'default_structure_id':structure_id,'default_user':uid}">
                                <!--'form_view_ref': 'proximas_medical.details_pec_phcie_form',-->
                                <form string="Détails de Prise en charge Assuré">
                                    <sheet>
                                        <group invisible="1">
                                            <field name="create_uid"/>
                                            <field name="write_uid"/>
                                            <field name="current_user"/>
                                            <field name="prestataire_phcie_id"/>
                                            <field name="pec_state"/>
                                            <field name="assure_id"
                                                   options='{"no_open": True, "no_create": True}'
                                                   readonly="1"/>
                                            <field name="prestataire_id"
                                                   options='{"no_open": True, "no_create": True}'
                                                   readonly="1"/>
                                            <field name="pool_medical_id" string="Médecin Prescripteur"
                                                   options='{"no_open": True, "no_create": True}'
                                                   domain="[('prestataire_id', '=', prestataire_id)]"/>
                                            <field name="prestataire_crs_id"
                                                   options='{"no_open": True, "no_create": True}'
                                                   readonly="1"/>
                                            <field name="pool_medical_crs_id"
                                                   options='{"no_open": True, "no_create": True}'
                                                   domain="[('prestataire_id', '=', prestataire_crs_id)]"
                                                   readonly="0"/>
                                        </group>
                                        <group>
                                            <field name="date_demande" required="1" string="Date Prescription"/>
                                            <field name="produit_phcie_id"
                                                   options='{"no_open": True, "no_create": True}'
                                                   required="1"
                                            />
                                            <field name="quantite" required="1"
                                                   string="Quantité Prescrite"
                                            />
                                            <field name="posologie"/>
                                            <field name="nbre_produit_phcie" invisible="1"/>
                                        </group>
                                        <!--<notebook>
                                            <page string="Prescription/Dispensation Médicaments">
                                            <page string="PRESCRIPTION MEDICAMENTS / MEDECIN"
                                                   attrs="{'readonly': [('date_demande','!=',False),
                                                   ('produit_phcie_id','!=',False),('quantite','>',0)]}"
                                            >
                                            </page>
                                        </notebook>-->
                                    </sheet>
                                </form>
                                <tree default_order="date_demande asc">
                                    <field name="date_demande"/>
                                    <field name="medicament" string="Médicaments Prescrits"/>
                                    <field name="quantite"/>
                                    <field name="pool_medical" string="Prescripteur"/>
                                    <field name="posologie"/>
                                    <!--<field name="cout_unit" string="Coût Unit."/>
                                    <field name="quantite_livre" string="Qté."/>
                                    <field name="cout_total" sum="S/Totaux"/>
                                    <field name="taux_couvert"/>
                                    <field name="net_tiers_payeur"  sum="Part SAM:"/>
                                    <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod.:"/>
                                    <field name="net_prestataire" sum="Totaux Dû (Prestataire):"/>-->
                                </tree>
                            </field>
                        </page>
                        <page string="DISPENSATION MEDICAMENTS - PHARMACIE"
                              attrs="{'invisible':['|','&amp;',('state','in',['dispense','termine']),
                              ('nbre_prescriptions_medecin','=',0),('state','in',['cours','oriente'])]}">
                            <field name="details_pec_dispensation_ids"
                                   widget="one2many"
                                   class="text-info"
                                   context="{
                                   'default_prestataire_id':prestataire_id,'default_assure_id':assure_id,
                                   'default_police_id':police_id,'default_prestataire_crs_id':prestataire_crs_id,
                                   'default_prestataire_phcie_id':prestataire_phcie_id,
                                   'default_structure_id':structure_id,'default_user':uid}">
                                <!--'form_view_ref': 'proximas_medical.details_pec_phcie_form',-->
                                <form string="Détails de Prise en charge Assuré">
                                    <sheet>
                                        <notebook>
                                            <!--<page string="Prescription/Dispensation Médicaments">-->
                                            <group col="6" colspan="2" invisible="1">
                                                <field name="produit_phcie"/>
                                                <field name="substitut_phcie"/>
                                                <field name="cout_unite"/>
                                                <field name="prestation_id" readonly="1"/>
                                                <field name="code_medical_id"/>
                                                <field name="police_id"/>
                                                <field name="structure_id"/>
                                                <field name="zone_couverte"/>
                                            </group>
                                            <group invisible="1">
                                                <field name="create_uid"/>
                                                <field name="write_uid"/>
                                                <field name="current_user"/>
                                                <field name="prestataire_phcie_id"/>
                                                <field name="pec_state"/>
                                                <field name="assure_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1"/>
                                                <field name="prestataire_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1"/>
                                                <field name="pool_medical_id" string="Médecin Prescripteur"
                                                       options='{"no_open": True, "no_create": True}'
                                                       domain="[('prestataire_id', '=', prestataire_id)]"/>
                                                <field name="prestataire_crs_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1"/>
                                                <field name="pool_medical_crs_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       domain="[('prestataire_id', '=', prestataire_crs_id)]"
                                                       readonly="0"/>
                                            </group>
                                            <page string="DISPENSATION MEDICAMENTS - PHARMACIE"
                                                   attrs="{'invisible': [('prestataire_phcie_id','=',False)]}">

                                                <div class="oe_title" name="title">
                                                <label for="prestataire_phcie_id" string="Pharmacie / Officine :"/>
                                                <h2 class="bg-success text-success">
                                                    <field name="prestataire_phcie_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1" sstring="Prestataire Conventionné - Pharmacie/Officine"/>
                                                </h2>
                                                </div>
                                                <newline/>
                                                <group>
                                                    <field name="medicament" class=" bg-success h4" string="Prescription"/>
                                                    <field name="date_execution" string="Date livraison (Méd.)"
                                                           attrs="{'required': [('prestataire_phcie_id','!=',False)]}"
                                                    />
                                                    <field name="produit_phcie_id"
                                                           string="Médicament"
                                                           invisible="1"
                                                           options='{"no_open": True, "no_create": True}'
                                                    />
                                                    <field name="substitut_phcie_id"  string="Substitut Produit"
                                                           options='{"no_open": True, "no_create": True}'
                                                    />
                                                </group>
                                                <hr/>
                                                <field name="quantite" invisible="1"/>
                                                <group col="6" colspan="2" class="bg-success">
                                                    <field name="quantite_demande"
                                                           string="Quantité Prescrite"
                                                           readonly="1"
                                                    />
                                                    <field name="date_dernier_acte" string="Date Dernier Acte"/>
                                                    <field name="exo_sam"/>
                                                    <!--<field name="exercice_id"-->
                                                           <!--string="Exercice SAM"-->
                                                           <!--options='{"no_open": True, "no_create": True}'/>-->
                                                </group>
                                                <group col="6" colspan="2">
                                                    <field name="quantite_livre" required="1"/>
                                                    <field name="cout_unit" required="1"/>
                                                    <field name="cout_total"/>
                                                    <field name="total_pc"/>
                                                    <field name="total_npc"/>
                                                    <field name="taux_couvert"/>
                                                    <field name="ticket_moderateur"
                                                           class="bg-success"
                                                    />
                                                    <field name="net_tiers_payeur"/>
                                                    <field name="net_prestataire"
                                                            class="bg-success"
                                                            string="NET A DEVOIR (SAM)"
                                                    />
                                                </group>
                                                <hr/>
                                                <group col="8" colspan="2" invisible="0">
                                                    <field name="mt_plafond_produit_phcie"/>
                                                    <field name="delai_attente_produit" string="Délai (jours)"/>
                                                    <field name="age_maximum"/>
                                                    <field name="age_minimum"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-success">
                                                    <field name="rubrique_id" string="Rubrisue médicale"
                                                           options='{"no_open": True, "no_create": True}'/>
                                                    <field name="ticket_exigible" string="Ticket Exigible?"/>
                                                    <field name="arret_produit" string="Médicament en arrêt?"/>
                                                </group>
                                                <group col="6" colspan="2" groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,
                                                        proximas_medical.group_medecin">
                                                    <field name="totaux_rubrique_assure" string="Sinistres Rubrique Assuré"/>
                                                    <field name="totaux_rubrique_contrat" string="Sinistres Rubrique Famille"/>
                                                    <field name="nbre_actes_rubrique_assure"/>
                                                    <field name="nbre_actes_rubrique_contrat" invisible="1"/>
                                                </group>
                                            </page>
                                        </notebook>
                                    </sheet>
                                </form>
                                <tree default_order="date_execution asc" create="0" delete="0">
                                    <!--<field name="pec_id"/>-->
                                    <field name="date_execution"/>
                                    <!--<field name="pool_medical_id"/>-->
                                    <field name="medicament" string="Produits/Pharmacie"/>
                                    <field name="quantite" string="Qté. Prescrite"/>
                                    <field name="quantite_livre" string="Qté. Livrée"/>
                                    <field name="cout_unit" string="Coût Unit."/>
                                    <field name="cout_total" sum="S/Totaux"/>
                                    <!--<field name="total_pc" sum="Totaux PC:"/>-->
                                    <field name="taux_couvert"/>
                                    <field name="net_tiers_payeur"  sum="Part SAM:"/>
                                    <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod.:"/>
                                    <!--<field name="mt_paye_assure" sum="Totaux Payé:"/>-->
                                    <field name="net_prestataire" string="S/TOTAUX" sum="Totaux Dû (Prestataire):"/>
                                    <!--<field name="debit_ticket" sum="Débit Ticket:"/>-->
                                </tree>
                            </field>
                            <group>
                                <group class="oe_subtotal_footer oe_right text-primary">
                                   <field name="part_sam_phcie_dispense"/>
                                   <field name="ticket_moderateur_phcie_dispense"/>
                                   <field name="mt_totaux_phcie_dispense" class="oe_subtotal_footer_separator"/>
                                   <field name="ticket_exigible_phcie_dispense"/>
                                   <field name="mt_encaisse_phcie_dispense" string="Montant Perçu (Ticket Modérateur)"/>
                                   <field name="net_prestataire_phcie_dispense" class="oe_subtotal_footer_separator"/>
                                </group>
                            </group>
                        </page>
                        <page string="PRESCRIPTION / DISPENSATION DE MEDICAMENTS"
                              attrs="{'invisible':['|',('state','not in',['dispense']),'&amp;',('state','in',['dispense']),('nbre_prescriptions_medecin','!=',0)]}">
                            <field name="details_pec_phcie_ids"
                                   widget="one2many"
                                   class="text-info"
                                   domain="['|',('prestataire_id', '!=', None)]"
                                   context="{
                                   'default_prestataire_id':prestataire_id,'default_assure_id':assure_id,'default_police_id':police_id,
                                   'default_prestataire_crs_id':prestataire_crs_id,'default_prestataire_phcie_id':prestataire_phcie_id,
                                   'default_structure_id':structure_id,'default_user':uid}">
                                <!--'form_view_ref': 'proximas_medical.details_pec_phcie_form',-->
                                <form string="Détails de Prise en charge Assuré">
                                    <sheet>
                                        <notebook>
                                            <!--<page string="Prescription/Dispensation Médicaments">-->
                                            <group invisible="1">
                                                <field name="create_uid"/>
                                                <field name="write_uid"/>
                                                <field name="current_user"/>
                                                <field name="prestataire_phcie_id"/>
                                                <field name="pec_state"/>
                                                <field name="assure_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1"/>
                                                <field name="prestataire_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1"/>
                                                <field name="pool_medical_id" string="Médecin Prescripteur"
                                                       options='{"no_open": True, "no_create": True}'
                                                       domain="[('prestataire_id', '=', prestataire_id)]"/>
                                                <field name="prestataire_crs_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       readonly="1"/>
                                                <field name="pool_medical_crs_id"
                                                       options='{"no_open": True, "no_create": True}'
                                                       domain="[('prestataire_id', '=', prestataire_crs_id)]"
                                                       readonly="0"/>
                                            </group>
                                            <page string="1. PRESCRIPTION MEDICAMENTS"
                                                   attrs="{'readonly': [('date_demande','!=',False),
                                                   ('produit_phcie_id','!=',False),('quantite','>',0)]}"
                                            >
                                                <group>
                                                    <field name="date_demande" required="1" string="Date Prescription"/>
                                                    <field name="produit_phcie_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           required="1"
                                                           />
                                                    <field name="quantite" required="1"
                                                           string="Quantité Prescrite"
                                                    />
                                                    <field name="posologie"/>
                                                    <field name="nbre_produit_phcie" invisible="1"/>
                                                </group>
                                            </page>
                                            <page string="2. DISPENSATION MEDICAMENTS - PHARMACIE"
                                                   attrs="{'invisible': [('prestataire_phcie_id','=',False)]}"
                                            >
                                                <div class="oe_title" name="title">
                                                    <label for="prestataire_phcie_id" string="Pharmacie / Officine :"/>
                                                    <h2 class="bg-success text-success">
                                                        <field name="prestataire_phcie_id"
                                                           options='{"no_open": True, "no_create": True}'
                                                           readonly="1" sstring="Prestataire Conventionné - Pharmacie/Officine"/>
                                                    </h2>
                                                </div>
                                                <newline/>
                                                <group>
                                                    <field name="medicament" class=" bg-success h4" string="Prescription"/>
                                                    <field name="date_execution" string="Date livraison (Méd.)"
                                                           attrs="{'required': [('prestataire_phcie_id','!=',False)]}"
                                                    />
                                                    <field name="substitut_phcie_id"  string="Substitut Produit"
                                                           options='{"no_open": True, "no_create": True}'
                                                    />
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-success">
                                                    <field name="quantite_demande"
                                                           string="Quantité Prescrite"
                                                           readonly="1"
                                                    />
                                                    <field name="date_dernier_acte" string="Date Dernier Acte"/>
                                                    <field name="exo_sam"/>
                                                    <!--<field name="exercice_id"-->
                                                           <!--string="Exercice SAM"-->
                                                           <!--options='{"no_open": True, "no_create": True}'/>-->
                                                </group>
                                                <group col="6" colspan="2" string="Détails Coûts du Médicament &amp; Montants annexes">
                                                    <field name="quantite_livre" required="1"/>
                                                    <field name="cout_unit"
                                                           required="1"
                                                    />
                                                    <field name="cout_total"/>
                                                    <field name="total_pc"/>
                                                    <field name="total_npc"/>
                                                    <field name="taux_couvert"/>
                                                    <field name="ticket_moderateur"
                                                           class="bg-success"
                                                    />
                                                    <field name="net_tiers_payeur"/>
                                                    <field name="net_prestataire"
                                                            class="bg-success"
                                                            string="NET A DEVOIR (SAM)"
                                                    />

                                                    <!--<field name="total_pc"/>
                                                    <field name="total_npc"/>
                                                    <field name="taux_couvert"/>
                                                    <field name="ticket_moderateur"/>
                                                    <field name="net_tiers_payeur"/>
                                                    <field name="ticket_exigible" string="Ticket Exigible?"/>
                                                    <field name="mt_paye_assure"
                                                           required="1"
                                                           string="Montant Encaissé"
                                                    />
                                                    <field name="net_prestataire"/>
                                                    <field name="debit_ticket"/>-->
                                                </group>
                                                <hr/>
                                                <group col="8" colspan="2" invisible="0">
                                                    <field name="mt_plafond_produit_phcie"/>
                                                    <field name="delai_attente_produit" string="Délai (jours)"/>
                                                    <field name="age_maximum"/>
                                                    <field name="age_minimum"/>
                                                </group>
                                                <hr/>
                                                <group col="6" colspan="2" class="bg-success">
                                                    <field name="rubrique_id" string="Rubrisue médicale"
                                                           options='{"no_open": True, "no_create": True}'/>
                                                    <field name="ticket_exigible" string="Ticket Exigible?"/>
                                                    <field name="arret_produit" string="Médicament en arrêt?"/>
                                                </group>
                                                <group col="6" colspan="2" groups="base.group_system,proximas_medical.group_manager,proximas_medical.group_operator,
                                                        proximas_medical.group_medecin">
                                                    <field name="totaux_rubrique_assure" string="Sinistres Rubrique Assuré"/>
                                                    <field name="totaux_rubrique_contrat" string="Sinistres Rubrique Famille"/>
                                                    <field name="nbre_actes_rubrique_assure"/>
                                                    <field name="nbre_actes_rubrique_contrat" invisible="1"/>
                                                </group>
                                                <group col="6" colspan="2" invisible="1">
                                                    <field name="produit_phcie"/>
                                                    <field name="substitut_phcie"/>
                                                    <field name="cout_unite"/>
                                                    <field name="prestation_id" readonly="1"/>
                                                    <field name="code_medical_id"/>
                                                    <field name="police_id"/>
                                                    <field name="structure_id"/>
                                                    <field name="zone_couverte"/>
                                                </group>
                                            </page>
                                        </notebook>
                                    </sheet>
                                </form>
                                <tree default_order="date_execution asc">
                                    <!--<field name="pec_id"/>-->
                                    <field name="date_execution"/>
                                    <!--<field name="pool_medical_id"/>-->
                                    <field name="medicament" string="Produits/Pharmacie"/>
                                    <field name="cout_unit" string="Coût Unit."/>
                                    <field name="quantite" string="Qté.Prescrite"/>
                                    <field name="quantite_livre" string="Qté. livrée"/>
                                    <field name="cout_total" sum="S/Totaux"/>
                                    <!--<field name="total_pc" sum="Totaux PC:"/>-->
                                    <field name="taux_couvert"/>
                                    <field name="net_tiers_payeur"  sum="Part SAM:"/>
                                    <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod.:"/>
                                    <!--<field name="mt_paye_assure" sum="Totaux Payé:"/>-->
                                    <field name="net_prestataire" sum="Totaux Dû (Prestataire):"/>
                                    <!--<field name="debit_ticket" sum="Débit Ticket:"/>-->
                                </tree>
                            </field>
                            <group>
                                <group class="oe_subtotal_footer oe_right text-primary">
                                   <field name="part_sam_phcie"/>
                                   <field name="ticket_moderateur_phcie"/>
                                   <field name="mt_totaux_phcie" class="oe_subtotal_footer_separator"/>
                                   <field name="ticket_exigible_phcie"/>
                                   <field name="mt_encaisse_phcie"
                                          string="Montant Perçu (Ticket Modérateur)"
                                   />
                                   <field name="net_prestataire_phcie" class="oe_subtotal_footer_separator"/>
                                </group>
                            </group>
                        </page>
                        <!--<page string="NOTES / OBSERVATION">
                            <field name="note"/>
                        </page>-->
                    </notebook>
                </sheet>
                <sheet position="after">
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user,group_admin"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </sheet>
            </form>
        </field>
    </record>
    <!-- RAPPORT DETAILLE PRISE EN CHARGE PAR USER PRESTATAIRE -->
    <record id="details_pec_user_tree_view" model="ir.ui.view">
        <field name="name">Détails PEC Traitées/Utilisateur</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Listing Détaillé PEC traitées" create="0" edit="0" delete="0">
                <field name="code_id" />
                <field name="name"/>
                <field name="age" />
                <field name="genre" />
                <field name="statut_familial"/>
                <field name="police_id"/>
                <field name="num_pec"/>
                <field name="date_execution"/>
                <field name="prestataire"/>
                <field name="details_prestation"/>
                <!--<field name="produit_phcie_id"/>
                <field name="substitut_phcie_id"/>-->
                <field name="cout_total" sum="Cout Total"/>
                <field name="total_pc" sum="S/Total PC"/>
                <field name="total_npc" sum="S/Total NPC"/>
                <field name="ticket_moderateur" sum="Ticket Mod."/>
                <field name="net_tiers_payeur" sum="Part SAM"/>
                <!--<field name="write_uid"/>-->
            </tree>
        </field>
    </record>
    <!-- ACTES MEDICAUX/PRESTATIONS DEMANDEEES -CRS - LIST-->
    <record id="validation_details_pec_demande_tree_view" model="ir.ui.view">
        <field name="name">Acts/Médicaux Demandés - CRS</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Listing Détaillé Acts/Prestations" create="0" >
                <field name="code_id" />
                <field name="name" string="Assuré"/>
                <field name="age" />
                <field name="genre" />
                <field name="statut_familial"/>
                <field name="num_pec"/>
                <field name="prestataire"/>
                <field name="details_prestation" string="Prestation/Acte"/>
                <field name="cout_total" sum="Cout Total"/>
                <field name="total_pc" sum="S/Total PC"/>
                <field name="total_npc" sum="S/Total NPC"/>
                <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod."/>
                <field name="net_tiers_payeur" sum="Part SAM"/>
                <field name="net_prestataire" sum="Net à payer"/>
                <field name="write_uid"/>
            </tree>
        </field>
    </record>
    <!-- VALIDATION ACTES MEDICAUX/PRESTATIONS CRS - LIST-->
    <record id="validation_details_pec_crs_tree_view" model="ir.ui.view">
        <field name="name">Validation Acts/Médicaux CRS</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Listing Détaillé Acts/Prestations" create="0" edit="1" delete="0">
                <field name="code_id" />
                <field name="name" string="Assuré"/>
                <field name="age" />
                <field name="genre" />
                <field name="statut_familial"/>
                <field name="num_pec"/>
                <field name="date_execution"/>
                <field name="prestataire"/>
                <field name="details_prestation" string="Prestation/Acte"/>
                <field name="cout_total" sum="Cout Total"/>
                <field name="total_pc" sum="S/Total PC"/>
                <field name="total_npc" sum="S/Total NPC"/>
                <field name="ticket_moderateur" string="Ticket Mod." sum="Ticket Mod."/>
                <field name="net_tiers_payeur" sum="Part SAM"/>
                <field name="net_prestataire" sum="Net à payer"/>
                <field name="is_valide"/>
            </tree>
        </field>
    </record>
    <!-- VALIDATION ACTES MEDICAUX/PRESTATIONS CRS - FORM-->
        <record id="validation_details_pec_crs_form" model="ir.ui.view">
           <field name="name">validation actes CRS form view</field>
           <field name="model">proximas.details.pec</field>
           <field name="arch" type="xml">
               <form string="Détails de Prise en charge CRS">
                   <header>
                       <button name="action_valider" string="Valider"
                                type="object" icon="fa-file-o" class="oe_highlight"
                                help="Validation de la prestation médicale."
                       />
                   </header>
                   <sheet>
                           <field name="image"
                               widget='image'
                               class="oe_left oe_avatar"
                               options="{'preview_image': 'image', 'size': [90, 120]}" />
                            <!--<field name="image" widget='image' class="oe_avatar oe_left"/>-->
                        <div class="oe_title" name="title">
                            <label for="pec_id" string="Assuré:"/>
                            <h2><field name="pec_id" class="text-primary" readonly="True"/></h2>
                            <!--<h3><field name="prenoms" class="text-primary" readonly="True"/></h3>-->
                            <b><field name="age_details" class="text-muted"/></b>
                            <h3><field name="statut_familial" class="text-muted"/> -
                                <field name="genre"/></h3>
                        </div>
                        <div class="text-info">
                            <div class="oe_left">
                                <label for="num_pec" string="Code PEC :"/>
                                <h2><field name="num_pec"/></h2>
                            </div>
                            <div class="oe_right text-right">
                                <label for="prestataire" string="Centre d'orientation:"/>
                                <h2>
                                    <field name="prestataire"
                                           options='{"no_open": True, "no_create": True}'
                                           class="text-success"
                                           readonly="1"
                                    />
                                </h2>
                            </div>
                        </div>
                       <notebook>
                           <page string="VALIDATION PRESTATIONS MEDICALES - CRS">
                               <group col="6" colspan="2">
                                   <!--<field name="assure_id"
                                          options='{"no_open": True, "no_create": True}'
                                          readonly="1" />-->
                                   <field name="pool_medical_crs_id"
                                          options='{"no_open": True, "no_create": True}'
                                          class="text-success"
                                          readonly="1"/>
                                   <field name="date_execution" readonly="1"/>
                                   <field name="details_prestation"
                                          class="text-primary"
                                          string="Prestation/Médicament"/>
                               </group>
                               <group invisible="1">
                                   <field name="police_id"/>
                                   <field name="rubrique_id" readonly="1"/>
                                   <field name="cout_unite"/>
                                   <field name="quantite_exige"/>
                                   <field name="cout_modifiable"/>
                               </group>
                               <separator/>
                               <group col="6" colspan="2">
                                   <field name="coefficient"
                                          attrs="{'invisible': [('quantite_exige','=',True)]}"/>
                                   <field name="quantite_livre" readonly="1"
                                          attrs="{'invisible': [('quantite_exige','=',False)]}"/>
                                   <field name="cout_unitaire"
                                          attrs="{'invisible': [('cout_modifiable','=',True)]}"/>
                                   <field name="cout_unit" readonly="1"
                                          attrs="{'invisible': [('cout_modifiable','=',False)]}"/>
                                   <field name="cout_total"/>
                                   <field name="total_pc"/>
                                   <field name="total_npc"/>
                                   <field name="taux_couvert"/>
                                   <field name="net_tiers_payeur"/>
                                   <field name="ticket_moderateur"/>
                                   <field name="net_prestataire"/>
                                   <field name="is_valide" readonly="1"/>
                                   <field name="motif_validation"/>
                               </group>
                               <hr/>
                               <group col="6" colspan="2" invisible="1">
                                   <field name="prestation_crs_id"/>
                                   <field name="prestation_id"/>
                                   <field name="code_medical_id"/>
                                   <field name="zone_couverte"/>
                               </group>
                           </page>
                       </notebook>
                   </sheet>
               </form>
           </field>
        </record>
    <!-- ACCORD PREALABLE ACTES MEDICAUX/PRESTATIONS CRS - LIST-->
    <record id="accord_details_pec_crs_tree_view" model="ir.ui.view">
        <field name="name">Accord Actes/Médicaux CRS</field>
        <field name="model">proximas.details.pec</field>
        <field name="arch" type="xml">
            <tree string="Listing Détaillé Acts/Prestations" create="0" edit="1" delete="0">
                <field name="date_demande"/>
                <field name="num_pec"/>
                <field name="code_id" />
                <field name="name" string="Assuré"/>
                <field name="age" />
                <field name="genre" />
                <field name="statut_familial"/>
                <field name="prestataire_id"/>
                <field name="pool_medical_id"/>
                <field name="prestation_demande_id" string="Prestation/Acte Demandé(e)"/>
                <field name="accord_prestation_demande"/>
                <field name="accorde"/>
                <field name="non_accorde"/>
            </tree>
        </field>
    </record>
    <!-- ACCORD PREALABLE ACTES MEDICAUX/PRESTATIONS CRS - FORM-->
    <record id="accord_details_pec_crs_form" model="ir.ui.view">
       <field name="name">accord actes CRS form view</field>
       <field name="model">proximas.details.pec</field>
       <field name="arch" type="xml">
           <form string="Détails de Prise en charge CRS" create="0" edit="1" delete="0">
               <header> </header>
               <sheet>
                    <field name="image"
                           widget='image'
                           class="oe_left oe_kanban_avatar"
                           options="{'preview_image': 'image', 'size': [120, 120]}" />
                        <!--<field name="image" widget='image' class="oe_avatar oe_left"/>-->
                    <div class="oe_title oe_left" name="title">
                        <label for="assure_id" string="Identification Assuré:"/>
                        <h3><field name="assure_id" class="text-primary" readonly="True"/></h3>
                        <b><field name="age_details" class="text-muted"/></b>
                        <h5><field name="statut_familial" class="text-muted"/></h5>
                        <h5><field name="genre" class="text-muted"/></h5>
                    </div>
                    <div class="oe_right">
                        <label for="pec_id" string="Référence PEC:"/>
                        <h3><field name="pec_id" class="text-primary" readonly="True"/></h3>
                        <label for="prestataire_id" string="Prestataire de soins - CRO:"/>
                        <h4><field name="prestataire_id" class="text-success" readonly="1"
                                   options='{"no_open": True, "no_create": True}'/></h4>
                        <!--<label for="pec_state" string="Statut PEC:"/>
                        <h4><field name="pec_state" class="text-success" readonly="1"/></h4>-->
                    </div>
                   <hr/>
                   <notebook>
                       <page string="PRESTATIONS MEDICALES DEMANDEES">
                           <group col="4" colspan="2">
                               <field name="num_pec"/>
                               <field name="date_demande" readonly="1"/>
                               <field name="pool_medical_id" options='{"no_open": True, "no_create": True}' readonly="1"/>
                               <field name="prestation_demande_id" options='{"no_open": True, "no_create": True}'
                                      class="text-primary" readonly="1"/>
                           </group>
                           <hr/>
                           <group col="4" colspan="2" class="text-success h4">
                               <field name="accorde" string="Autorisée"/>
                               <field name="non_accorde" string="Rejetée"/>
                           </group>
                           <hr/>
                           <group invisible="1">
                               <field name="police_id"/>
                               <field name="rubrique_id" readonly="1"/>
                               <field name="cout_unite"/>
                               <field name="quantite_exige"/>
                               <field name="cout_modifiable"/>
                           </group>
                       </page>
                       <page string="MOTIF DE REFUS - ACCORD PREALABLE"
                             attrs="{'invisible': [('non_accorde','=',False)]}">
                           <group>
                               <field name="motif_non_accord"
                                      attrs="{'required': [('non_accorde','=',True)]}"
                               />
                           </group>
                       </page>
                       <page string="INFORMATIONS CLINIQUES">
                           <group>
                               <field name="info_clinique"/>
                           </group>
                       </page>
                   </notebook>
               </sheet>
           </form>
       </field>
    </record>
    <!-- PRISE EN CHARGE CREATION WIZARD FORM -->
    <record id='proximas_pec_create_wizard_form' model='ir.ui.view'>
        <field name='name'>Assistant Création de Prise en charge view</field>
        <field name='model'>proximas.pec.wizard</field>
        <field name='arch' type='xml'>
            <form string="Création Prise en charge Assuré">
                <sheet>
                    <div class="panel">
                        <h4 class="panel-header text-primary">
                          Création de Prise en charge médicale (Centre de Référence Obligatoire):
                      </h4>
                      <div class="panel-body">
                        <blockquote class="blockquote mb-0 h5">
                            <!--<separator class="text-success fa fa-plus-square"/>-->
                          <p class="text-primary h5">Cet assistant vous permet de démarrer la procédure de traitement d'une
                              prise en charge pour le compte d'un assuré sur présentation de sa carte d'accès aux soins.
                          </p>
                          <p class="text-primary h5">Pour commencer le traitement de la prise en charge, vous allez
                              indiquer le Code d'identification du patient, inscrit sur la carte d'accès, dans le
                              champ ci-dessous :
                              <field name='code_saisi'  class="text-primary h4"
                                     default_focus="1"
                                     placeholder="Ex.: 01234567AB"/>
                              <hr/>
                          </p>
                      <!--<h4 class="panel-header text-primary">Assistant de Création Nouvelle Prise en charge : </h4>
                      <div class="panel-body">
                        <blockquote class="blockquote mb-0">
                          <p class="text-primary">Cet assistant vous permet de créer une nouvelle prise en charge pour un assuré.
                              Vous devez au préalable, vous munir de la carte d'accès aux soins du patient concerné.
                              Pour commencer le traitement de la prise en charge, vous allez indiquer le Code d'identification
                              inscrit sur la carte dans le champ ci-dessous :
                              <hr/>
                              &lt;!&ndash;<label for="code_saisii" string="Code Identification:" />&ndash;&gt;
                              <group>
                                  <field name='code_saisi' class="text-primary h4"
                                     default_focus="true"
                                     placeholder="Ex.: 01234567AB"/>
                              </group>
                          </p>-->
                          <footer class="blockquote-footer h5"><b>IMPORTANT:</b> Veuillez prendre soins de renseigner tous les champs :
                              <cite title="Ceux dont le fond est colorié">Champs obligatoires?</cite>
                          </footer>
                        </blockquote>
                      </div>
                    </div>
                </sheet>
                <footer>
                    <button name='open_popup'
                        string='Valider'
                        class='btn-primary'
                        type='object'/>
                                /
                    <button string='Annuler'
                        class='btn-default'
                        special='cancel'/>
                </footer>
            </form>
        </field>
    </record>
    <!-- PRISE EN CHARGE MAJ WIZARD FORM - PHARMACIE-->
    <record id='proximas_pec_maj_phcie_wizard_form' model='ir.ui.view'>
        <field name='name'>Assistant Mise à jour de Prise en charge view</field>
        <field name='model'>proximas.pec.maj.wizard</field>
        <field name='arch' type='xml'>
            <form string="Mise à jour Prise en charge Assuré">
                <sheet>
                    <div class="panel">
                      <h4 class="panel-header text-primary">
                          Assistant Dispensation Médicaments (Pharmacies/Officines):
                      </h4>
                      <div class="panel-body">
                        <blockquote class="blockquote mb-0 h5">
                            <!--<separator class="text-success fa fa-plus-square"/>-->
                          <p class="text-primary h5">Cet assistant vous permet de démarrer la procédure de traitement d'une
                              prise en charge en vue de dispenser des médicaments à l'assuré sur présentation de son bon
                              de prise en charge accompagné de sa carte d'accès aux soins.
                          </p>
                          <p class="text-primary h5">Pour commencer le traitement de la prise en charge, vous allez
                              indiquer le Code PEC inscrit sur le bon de prise en charge dans le champ ci-dessous :
                              <field name='code_pec'  class=" oe_left text-primary h4"
                                     default_focus="1"
                                     placeholder="Ex.: 0001234567"/>
                              <hr/>
                          </p>
                              <!--<label for="code_pec" string="Code PEC:" />-->

                          <footer class="blockquote-footer h5"><b>IMPORTANT:</b> Veuillez prendre soins de renseigner tous les champs :
                              <cite title="Ceux dont le fond est colorié">Champs obligatoires?</cite>
                          </footer>
                        </blockquote>
                      </div>
                    </div>
                </sheet>
                <footer>
                    <button name='phcie_open_popup'
                        string='Valider'
                        class='btn-primary'
                        type='object'/>
                                /
                    <button string='Annuler'
                        class='btn-default'
                        special='cancel'/>
                </footer>
            </form>
        </field>
    </record>
    <!-- PRISE EN CHARGE MAJ WIZARD FORM - CRS-->
    <record id='proximas_pec_maj_wizard_form' model='ir.ui.view'>
        <field name='name'>Assistant Mise à jour de Prise en charge view</field>
        <field name='model'>proximas.pec.maj.wizard</field>
        <field name='arch' type='xml'>
            <form string="Mise à jour Prise en charge Assuré">
                <sheet>
                    <div class="panel">
                      <h4 class="panel-header text-primary">Assistant Mise à jour (Poursuite) de Prise en charge : </h4>
                      <div class="panel-body">
                        <blockquote class="blockquote mb-0">
                          <p class="text-primary h5">Cet assistant vous permet de poursuivre une prise en charge pour un assuré. Pour commencer
                              le traitement de la prise en charge, vous allez indiquer le Code PEC inscrit sur la prise
                              en charge dans le champ ci-dessous :
                          </p>
                          <p>

                              <hr/>
                              <label for="code_pec" string="Code PEC:" />
                              <field name='code_pec' class="text-primary h4"
                                     default_focus="1"
                                     placeholder="Ex.: 0001234567"/>
                          </p>
                          <footer class="blockquote-footer h5"><b>IMPORTANT:</b> Veuillez prendre soins de renseigner tous les champs :
                              <cite title="Ceux dont le fond est colorié">Champs obligatoires?</cite>
                          </footer>
                        </blockquote>
                      </div>
                    </div>
                </sheet>
                <footer>
                    <button name='crs_open_popup'
                        string='Valider'
                        class='btn-primary'
                        type='object'/>
                                /
                    <button string='Annuler'
                        class='btn-default'
                        special='cancel'/>
                </footer>
            </form>
        </field>
    </record>
    <record model="ir.actions.act_window" id="proximas_maj_phcie_pec_action">
        <field name="name">Proximaas: Dispensation Médicaments (Pharmacie)</field>
        <field name="res_model">proximas.pec.maj.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="proximas_pec_maj_phcie_wizard_form"/>
        <field name="target">new</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_maj_crs_pec_action">
        <field name="name">Proximaas: Complément de Prise en charge (CRS)</field>
        <field name="res_model">proximas.pec.maj.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="proximas_pec_maj_wizard_form"/>
        <field name="target">new</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_crea_pec_action">
        <field name="name">Proximaas: Nouvelle Prise en charge</field>
        <field name="res_model">proximas.pec.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="proximas_pec_create_wizard_form"/>
        <field name="target">new</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>
    <!--<record model="ir.actions.act_window" id="proximas_user_list_pec_action">
        <field name="name">Proximaas: Gestion Prise en charge (En attente)</field>
        <field name="res_model">proximas.prise.charge</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">['&amp;',('state','=','cours'),('user_prise_charge','!=','0')]</field>
        <field name="context">{}</field>
    </record>-->
    <record model="ir.actions.act_window" id="proximas_prestataire_pec_list_action">
        <field name="name">Proximaas: Gestion Prise en charge médicales (en cours)</field>
        <field name="res_model">proximas.prise.charge</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','cours'),('create_uid','=',uid)]</field>
        <field name="context">{'default_user_id':uid}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_list_pec_action">
        <field name="name">Proximaas: Gestion Prise en charge médicales</field>
        <field name="res_model">proximas.prise.charge</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_list_pec_filter_action">
        <field name="name">Proximaas: Filtre Prise en charge médicales</field>
        <field name="res_model">proximas.prise.charge</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="proximas_pec_list_filter_view"/>
        <field name="search_id" ref="prise_charge_view_search"/>
        <field name="domain">[]</field>
        <field name="context">{}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_details_pec_user_action">
        <field name="name">Proximaas: Rapport - Détails Prises en charge Traitées</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="details_pec_user_tree_view"/>
        <field name="domain">[('date_execution','!=',None),('en_cours_exo','=',True),('facture_id','=',None)]</field>
        <field name="context">{'default_user_id':uid}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_accord_details_pec_crs_action">
        <field name="name">Proximaas: Gestion Accords Préalables - Demandes Actes/Prestations</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="accord_details_pec_crs_tree_view"/>
        <field name="domain">[('date_execution','=',None),('date_demande','!=', None),('facture_id','=',None),
            ('accorde','=',False),('non_accorde','=',False),('en_cours_exo','=',True),('accord_prestation_demande','=',True),]</field>
        <field name="context">{'default_user_id':uid,'form_view_ref':'proximas_medical.accord_details_pec_crs_form'}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_list_accord_details_pec_crs_action">
        <field name="name">Proximaas: Liste Demandes Accords Actes/Prestations Traitées</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="accord_details_pec_crs_tree_view"/>
        <field name="domain">[('date_demande','!=', None),('en_cours_exo','=',True),('accord_prestation_demande','=',True),'|',('accorde','=',True),('non_accorde','=',True)]</field>
        <field name="context">{'default_user_id':uid,'form_view_ref':'proximas_medical.accord_details_pec_crs_form'}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_validation_details_pec_crs_action">
        <field name="name">Proximaas: Validation des Actes/Prestations CRS (Non demandés)</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="validation_details_pec_crs_tree_view"/>
        <field name="domain">[('date_execution','!=',None),('date_demande','=', None),('en_cours_exo','=',True),('prestation_crs_id','!=',None),('facture_id','=',None)]</field>
        <field name="context">{'default_user_id':uid,'form_view_ref':'proximas_medical.validation_details_pec_crs_form'}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_details_pec_demande_action">
        <field name="name">Proximaas: Prestations Demandées Non Traitées - CRS</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="validation_details_pec_demande_tree_view"/>
        <field name="domain">[('date_execution','=',None),('date_demande','!=', None),('en_cours_exo','=',True),('facture_id','=',None)]</field>
        <field name="context">{'default_user_id':uid}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_details_pec_action">
        <field name="name">Proximaas: Gestion Prestations - Prise en charge</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="proximas_details_pec_list_view"/>
        <field name="domain">[('date_execution','!=',None)]</field>
        <field name="context">{}</field>
    </record>
    <record model="ir.actions.act_window" id="proximas_details_pec_encours_action">
        <field name="name">Proximaas: Gestion Prestations Médicales En Cours</field>
        <field name="res_model">proximas.details.pec</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="proximas_details_pec_track_list"/>
        <field name="search_view_id" ref="details_pec_search_view"/>
        <field name="domain">[('date_execution','!=',None)]</field>
        <field name="context">{}</field>
    </record>
</odoo>